---
product: adobe campaign
title: ジャーニーのテスト
description: ジャーニーのテストについて説明します
feature: Journeys
role: User
level: Intermediate
exl-id: be413905-0631-4229-a954-80a92651206d
source-git-commit: 052ecdeb0813dcc2c4c870e8ec6b12676fbf60f1
workflow-type: tm+mt
source-wordcount: '1592'
ht-degree: 90%

---

# ジャーニーのテスト{#testing_the_journey}

エラーがある場合は、ジャーニーをテストする前にすべてのエラーを解決する必要があります。[この節](../about/troubleshooting.md#section_h3q_kqk_fhb)を参照してください。

テストプロファイルを使用して、ジャーニーを公開する前にテストすることができます。これにより、公開前に、個人がジャーニー内をどのように移動するかを分析し、トラブルシューティングをおこなうことができます。

テストモードでは、テストプロファイルのみがジャーニーにエントリできます。新しいテストプロファイルを作成するか、既存のプロファイルをテストプロファイルに変換します。[この節](../building-journeys/creating-test-profiles.md)を参照してください。

テストモードを使用するには、次の手順に従います。

1. ジャーニーをテストする前に、ジャーニーが有効であり、エラーがないことを確認します。ジャーニーにエラーがある場合は、テストを開始できません。[この節](../about/troubleshooting.md#section_h3q_kqk_fhb)を参照してください。エラーがある場合は、警告記号が表示されます。

1. テストモードをアクティブにするには、右上隅にある「**[!UICONTROL テスト]**」トグルをクリックします。

   ![](../assets/journeytest1.png)

1. 左下隅の&#x200B;**[!UICONTROL 待機時間]**&#x200B;パラメーターを使用して、テストモードで各待機アクティビティとイベントタイムアウトを継続させる時間を定義します。待機とイベントタイムアウトのデフォルト時間は 10 秒です。これにより、テスト結果を迅速に取得できます。このパラメーターが表示されるのは、ジャーニーに 1 つ以上の待機アクティビティーをドロップした場合だけです。

   ![](../assets/journeytest_wait.png)

   >[!NOTE]
   >
   >タイムアウトのある反応イベントをジャーニーで使用する場合、待機時間のデフォルト値は最小値の 40 秒になります。[この節](../building-journeys/reaction-events.md)を参照してください。

1. 「**[!UICONTROL イベントをトリガー]**」をクリックしてイベントを設定し、ジャーニーに送信します。

   ![](../assets/journeyuctest1.png)

1. 必要に応じて、様々なフィールドを設定します。**プロファイル ID** フィールドに、テストプロファイルの識別に使用するフィールドの値を入力します。これには、メールアドレスなどを使用できます。テストプロファイルに関連するイベントを送信します。[イベントの実行](#firing_events)を参照してください。

   ![](../assets/journeyuctest1-bis.png)

1. イベントを受け取ったら、「**[!UICONTROL ログの表示]**」ボタンをクリックし、テスト結果を表示して確認します。[ログの表示](#viewing_logs)を参照してください。

   ![](../assets/journeyuctest2.png)

1. エラーがある場合は、テストモードを無効にし、ジャーニーを修正してから再度テストします。テストが終了すれば、ジャーニーを公開できます。[このページ](../building-journeys/publishing-the-journey.md)を参照してください。

## 重要な注意事項 {#important_notes}

* イベントを実行できるインターフェイスがテストしたジャーニーに提供されますが、イベントは Postman などのサードパーティシステムからも送信できます。
* リアルタイム顧客プロファイルサービスで「テストプロファイル」としてフラグ付けされた個人のみがテストジャーニーにエントリできます。[この節](../building-journeys/creating-test-profiles.md)を参照してください。
* テストモードは、名前空間を使用するドラフトジャーニーでのみ使用できます。テストモードでは、ジャーニーにエントリする人がテストプロファイルであるかどうかを確認する必要があります。そのため、Adobe Experience Platformに到達する必要があります。
* ジャーニーにエントリできるテストプロファイルの数は、1 回のテストセッション中に最大 100 です。
* テストモードを無効にすると、過去にジャーニーにエントリしたすべての人々と、現在エントリしているすべての人々がジャーニーから削除されます。また、レポートも消去します。
* テストモードは、必要であれば何回でも有効または無効にできます。
* テストモードがアクティブになっているときは、ジャーニーを変更できません。テストモードではジャーニーを直接公開できるので、事前にテストモードを無効にしておく必要はありません。
* 分割に達すると、常に一番上の分岐を選択します。テストで別のパスを選択する場合は、分割された分岐の位置を再編成できます。
* パフォーマンスを最適化し、古くなったリソースの使用を防ぐために、1 週間トリガーされていないテストモードのジャーニーはすべて、ドラフトステータスに戻ります。

## プロファイルからテストプロファイルへの変換{#turning-profile-into-test}

既存のプロファイルをテストプロファイルに変換できます。Adobe Experience Platformでは、API 呼び出しを使用してプロファイル属性を更新できますが、インターフェイスを使用して実行することはできません。

これを行う最も簡単な方法は、 **プロファイルを更新** 「 」アクションアクティビティを実行し、テストプロファイルの boolean フィールドを false から true に変更します。 [この節](../building-journeys/update-profiles.md#using-the-test-mode)を参照してください。

## テストプロファイルの作成{#create-test-profile}

新しいテストプロファイルを作成する場合の手順は、Adobe Experience Platformでプロファイルを作成する場合の手順と同じです。 API 呼び出しを通じて実行されます。 詳しくは、 [ページ](https://experienceleague.adobe.com/docs/experience-platform/profile/home.html?lang=ja)

「profile test details」mixin を含むプロファイルスキーマを使用する必要があります。 testProfile フラグは、この Mixin の一部です。

プロファイルを作成する場合は、次の値を渡す必要があります：testProfile = true

既存のプロファイルを更新して、testProfile フラグを「true」に変更することもできます。

テストプロファイルを作成するための API 呼び出しの例を以下に示します。

```
curl -X POST \
'https://dcs.adobedc.net/collection/xxxxxxxxxxxxxx' \
-H 'Cache-Control: no-cache' \
-H 'Content-Type: application/json' \
-H 'Postman-Token: xxxxx' \
-H 'cache-control: no-cache' \
-H 'x-api-key: xxxxx' \
-H 'x-gw-ims-org-id: xxxxx' \
-d '{
"header": {
"msgType": "xdmEntityCreate",
"msgId": "xxxxx",
"msgVersion": "xxxxx",
"xactionid":"xxxxx",
"datasetId": "xxxxx",
"imsOrgId": "xxxxx",
"source": {
"name": "Postman"
},
"schemaRef": {
"id": "https://example.adobe.com/mobile/schemas/xxxxx",
"contentType": "application/vnd.adobe.xed-full+json;version=1"
}
},
"body": {
"xdmMeta": {
"schemaRef": {
"contentType": "application/vnd.adobe.xed-full+json;version=1"
}
},
"xdmEntity": {
"_id": "xxxxx",
"_mobile":{
"ECID": "xxxxx"
},
"testProfile":true
}
}
}'
```

## イベントの実行 {#firing_events}

「**[!UICONTROL イベントをトリガー]**」ボタンを使用すると、イベントを設定して、人がジャーニーにエントリできるようにできます。

>[!NOTE]
>
>テストモードでイベントをトリガーすると、実際のイベントが生成されます。つまり、このイベントをリッスンしている他のジャーニーもヒットします。

前提条件として、Adobe Experience Platformでテストプロファイルとしてフラグ付けされたプロファイルを把握しておく必要があります。 実際、テストモードでは、ジャーニーでこれらのプロファイルのみが許可され、イベントには ID を含める必要があります。必要な ID は、イベント設定に応じて異なります。この ID には、ECID やメールアドレスなどを使用できます。このキーの値は、**プロファイル識別子**&#x200B;フィールドに追加する必要があります。

>[!NOTE]
>
>列挙を想定するフィールドにドロップダウンが表示されます。 表示される値の 1 つを選択するだけで設定できます。

ジャーニーに複数のイベントが含まれる場合は、ドロップダウンリストを使用してイベントを選択します。次に、各イベントに対して、渡されるフィールドと送信するイベントの実行を設定します。インターフェイスは、イベントペイロードに正しい情報を渡し、情報タイプが正しいことを確認するのに役立ちます。テストモードでは、後で使用するために、テストセッションで最後に使用したパラメーターが保存されます。

![](../assets/journeytest4.png)

このインターフェイスを使用すると、単純なイベントパラメーターを渡すことができます。イベント内のコレクションや他の高度なオブジェクトを渡す場合は、「**[!UICONTROL コードビュー]**」をクリックして、ペイロードのコード全体を表示し、変更することができます。例えば、技術ユーザーが作成したイベント情報をコピーして貼り付けることができます。

![](../assets/journeytest5.png)

技術ユーザーは、このインターフェイスを使用してイベントペイロードを作成して、サードパーティのツールを使用せずにイベントをトリガーすることもできます。

「**[!UICONTROL 送信]**」ボタンをクリックすると、テストが開始されます。ジャーニー内の個人の進行状況は、視覚的なフローで表現されます。個人がジャーニー間を移動すると、パスは徐々に緑に変わります。エラーが発生した場合は、対応する手順に警告記号が表示されます。その警告記号上にカーソルを置くと、エラーに関する詳細情報が表示され、（利用可能な場合は）詳細情報にアクセスできます。

![](../assets/journeytest6.png)

イベント設定画面で別のテストプロファイルを選択し、再びテストを実行すると、視覚的なフローが消去され、新しい個人のパスが表示されます。

テストでジャーニーを開くと、最後に実行されたテストに対応するパスが表示されします。

視覚的なフローは、イベントがインターフェイスと外部（Postman などを使用）のどちらでトリガーされるかに関係なく機能します。

## ルールベースのジャーニーのテストモード {#test-rule-based}

テストモードは、ルールベースのイベントを使用するジャーニーでも使用できます。ルールベースのイベントについて詳しくは、[このページ](../event/about-events.md)を参照してください。

イベントをトリガーする際、**イベント設定**&#x200B;画面で、テストに合格するイベントパラメーターを定義できます。イベント ID 条件を表示するには、右上隅のツールチップアイコンをクリックします。各フィールド（ルール評価の一部）の横にあるツールヒントも利用できます。

![](../assets/alpha-event8.png)

テストモードの使い方について詳しくは、[このページ](../building-journeys/testing-the-journey.md)を参照してください。

## ログの表示 {#viewing_logs}

「**[!UICONTROL ログを表示]**」ボタンを使用すると、テスト結果を表示できます。このページには、ジャーニーの現在の情報が JSON 形式で表示されます。ボタンを使用すると、ノード全体をコピーできます。ジャーニーのテスト結果を更新するには、ページを手動で更新する必要があります。

![](../assets/journeytest3.png)

>[!NOTE]
>
>テストログで、サードパーティシステム（データソースまたはアクション）の呼び出し時にエラーが発生した場合は、エラーコードとエラー応答が表示されます。

現在、ジャーニー内にいる個人の数（技術的にはインスタンスと呼ばれます）が表示されます。各個人に表示される便利な情報を次に示します。

* _ID_：ジャーニー内の個人の内部 ID。デバッグ目的で使用できます。
* _currentstep_：個人がジャーニーにいるステップ。アクティビティを識別しやすくするために、アクティビティにラベルを追加することをお勧めします。
* _currentstep_ > フェーズ：個人のジャーニーのステータス（実行中、完了、エラーまたはタイムアウト）。詳しくは、以下を参照してください。
* _currentstep_ > _extraInfo_：エラーの説明と、その他のコンテキスト情報。
* _currentstep_ > _fetchErrors_：この手順中に発生したデータ取得エラーに関する情報。
* _externalKeys_：イベントで定義されているキー式の値。
* _enrichedData_：ジャーニーがデータソースを使用している場合にジャーニーが取得したデータ。
* _transitionHistory_：個人が踏んだ手順のリスト。イベントの場合、ペイロードが表示されます。
* _actionExecutionErrors_：発生したエラーに関する情報。

個人のジャーニーには様々なステータスがあります。

* _実行中_：個人は現在ジャーニーの途中にいます。
* _完了_：個人はジャーニーの最後にいます。
* _エラー_：エラーが発生したため、個人のジャーニーは停止しました。
* _タイムアウト_：時間がかかり過ぎたので、個人のジャーニーは停止しました。

テストモードでイベントをトリガーすると、ソースの名前が付いたデータセットが自動的に生成されます。

テストモードでイベントをトリガーすると、ソースの名前が付いたデータセットが自動的に生成されます。

テストモードでは、エクスペリエンスイベントが自動的に作成され、Adobe Experience Platform に送信されます。このエクスペリエンスイベントのソース名は、「Journey Orchestration テストイベント」です。
