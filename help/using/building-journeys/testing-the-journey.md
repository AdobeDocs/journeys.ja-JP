---
product: adobe campaign
title: ジャーニーのテスト
description: 'ジャーニーテストの詳細 '
feature: ジャーニー
role: Business Practitioner
level: Intermediate
exl-id: be413905-0631-4229-a954-80a92651206d
source-git-commit: 712f66b2715bac0af206755e59728c95499fa110
workflow-type: tm+mt
source-wordcount: '1654'
ht-degree: 4%

---

# ジャーニーのテスト{#testing_the_journey}

ジャーニーをテストする前に、すべてのエラーが発生した場合は解決する必要があります。 詳しくは、[この節](../about/troubleshooting.md#section_h3q_kqk_fhb)を参照してください。

テストプロファイルを使用して、公開前にジャーニーをテストすることができます。 これにより、公開前に、個人がジャーニー内をどのように移動しているかを分析し、トラブルシューティングをおこなうことができます。

テストモードでジャーニーに入れるのは、テストプロファイルのみです。 新しいテストプロファイルを作成するか、既存のプロファイルをテストプロファイルに変換することができます。 [こちら](../building-journeys/creating-test-profiles.md)を参照してください。

テストモードを使用するには、次の手順に従います。

1. ジャーニーをテストする前に、ジャーニーが有効でエラーがないことを確認します。 エラーが発生したジャーニーのテストを開始することはできません。 詳しくは、[この節](../about/troubleshooting.md#section_h3q_kqk_fhb)を参照してください。エラーが発生すると、警告記号が表示されます。

1. テストモードを有効にするには、右上隅にある&#x200B;**[!UICONTROL テスト]**&#x200B;切り替えをクリックします。

   ![](../assets/journeytest1.png)

1. 左下隅の&#x200B;**[!UICONTROL 待機時間]**&#x200B;パラメーターを使用して、各待機アクティビティとイベントのタイムアウトがテストモードで持続する時間を定義します。 デフォルトの時間は、待機とイベントのタイムアウトに対して10秒です。 これにより、テスト結果を迅速に取得できます。 このパラメーターは、1つ以上の待機アクティビティをジャーニーにドロップした場合にのみ表示されます。

   ![](../assets/journeytest_wait.png)

   >[!NOTE]
   >
   >リアクションイベントをジャーニーで使用する場合、待機時間のデフォルト値と最小値は40秒です。 詳しくは、[この節](../building-journeys/reaction-events.md)を参照してください。

1. 「**[!UICONTROL イベントをトリガー]**」をクリックして、イベントを設定し、ジャーニーに送信します。

   ![](../assets/journeyuctest1.png)

1. 必要に応じて、様々なフィールドを設定します。 「**Profile Identifier**」フィールドに、テストプロファイルの識別に使用するフィールドの値を入力します。 例えば、Eメールアドレスを指定できます。 テストプロファイルに関連するイベントを必ず送信してください。 [イベントの発生](#firing_events)を参照してください。

   ![](../assets/journeyuctest1-bis.png)

1. イベントを受け取ったら、「**[!UICONTROL Show log]**」ボタンをクリックしてテスト結果を表示し、確認します。 [ログの表示](#viewing_logs)を参照してください。

   ![](../assets/journeyuctest2.png)

1. エラーが発生した場合は、テストモードをオフにし、ジャーニーを変更して再度テストします。テストの最終的な結果が得られたら、ジャーニーを公開できます。 [このページ](../building-journeys/publishing-the-journey.md)を参照してください。

## 重要な注意事項 {#important_notes}

* テスト済みのジャーニーに対してイベントを発生させるインターフェイスが提供されますが、イベントはPostmanなどのサードパーティシステムからも送信できます。
* リアルタイム顧客プロファイルサービスで「テストプロファイル」とフラグ付けされた個人のみが、テスト済みのジャーニーに参加できます。 [こちら](../building-journeys/creating-test-profiles.md)を参照してください。
* テストモードは、名前空間を使用するドラフトジャーニーでのみ使用できます。 テストモードでは、ジャーニーにエントリする人がテストプロファイルであるかどうかを確認する必要があるので、Adobe Experience Platformに到達できる必要があります。
* テストセッション中にジャーニーに入ることのできるテストプロファイルの最大数は100です。
* テストモードを無効にすると、過去にテストモードに入った人、または現在そのモードにいる人がすべてジャーニーを空にします。 また、レポートもクリアされます。
* テストモードは、必要な回数だけ有効または無効にできます。
* テストモードが有効になっている場合、ジャーニーを変更することはできません。 テストモードの場合は、ジャーニーを直接公開できます。以前は、テストモードを非アクティブ化する必要はありません。

## プロファイルをテストプロファイルに変換する{#turning-profile-into-test}

既存のプロファイルをテストプロファイルに変換できます。 Adobe Experience Platformでは、API呼び出しを使用してプロファイル属性を更新できますが、インターフェイスを使用して実行することはできません。

これをおこなう最も簡単な方法は、「**プロファイル**&#x200B;を更新」アクションアクティビティを使用して、テストプロファイルのbooleanフィールドをfalseからtrueに変更することです。 詳しくは、[この節](../building-journeys/update-profiles.md#using-the-test-mode)を参照してください。

## テストプロファイル{#create-test-profile}の作成

新しいテストプロファイルを作成する場合の手順は、Adobe Experience Platformでプロファイルを作成する場合の手順と同じです。 API呼び出しを通じて実行されます。 この[ページ](https://docs.adobe.com/content/help/ja-JP/experience-platform/profile/home.html)を参照してください。

「プロファイルテストの詳細」mixinを含むプロファイルスキーマを使用する必要があります。 testProfileフラグはこのmixinの一部です。

プロファイルを作成する場合は、次の値を渡す必要があります。testProfile = true

既存のプロファイルを更新して、そのtestProfileフラグを「true」に変更することもできます。

テストプロファイルを作成するためのAPI呼び出しの例を以下に示します。

```
curl -X POST \
'https://dcs.adobedc.net/collection/xxxxxxxxxxxxxx' \
-H 'Cache-Control: no-cache' \
-H 'Content-Type: application/json' \
-H 'Postman-Token: xxxxx' \
-H 'cache-control: no-cache' \
-H 'x-api-key: xxxxx' \
-H 'x-gw-ims-org-id: xxxxx' \
-d '{
"header": {
"msgType": "xdmEntityCreate",
"msgId": "xxxxx",
"msgVersion": "xxxxx",
"xactionid":"xxxxx",
"datasetId": "xxxxx",
"imsOrgId": "xxxxx",
"source": {
"name": "Postman"
},
"schemaRef": {
"id": "https://example.adobe.com/mobile/schemas/xxxxx",
"contentType": "application/vnd.adobe.xed-full+json;version=1"
}
},
"body": {
"xdmMeta": {
"schemaRef": {
"contentType": "application/vnd.adobe.xed-full+json;version=1"
}
},
"xdmEntity": {
"_id": "xxxxx",
"_mobile":{
"ECID": "xxxxx"
},
"testProfile":true
}
}
}'
```

## イベントの発生 {#firing_events}

「**[!UICONTROL トリガーとイベント]**」ボタンを使用すると、人がジャーニーにエントリするためのイベントを設定できます。

>[!NOTE]
>
>テストモードでイベントをトリガーすると、実際のイベントが生成され、このイベントをリッスンしている他のジャーニーにもヒットします。

前提条件として、Adobe Experience Platformでテストプロファイルとしてフラグが設定されているプロファイルを把握しておく必要があります。 実際、テストモードでは、ジャーニーでこれらのプロファイルのみが許可され、イベントにはIDを含める必要があります。 想定されるIDは、イベント設定によって異なります。 例えば、ECIDや電子メールアドレスを指定できます。 このキーの値を&#x200B;**Profile Identifier**&#x200B;フィールドに追加する必要があります。

>[!NOTE]
>
>列挙が必要なフィールドのドロップダウンが表示されます。 表示される値の 1 つを選択するだけで設定できます。

ジャーニーに複数のイベントが含まれる場合は、ドロップダウンリストを使用してイベントを選択します。 次に、各イベントに対して、渡されるフィールドとイベント送信の実行を設定します。 インターフェイスは、イベントペイロードに適切な情報を渡し、情報タイプが正しいことを確認するのに役立ちます。 テストモードは、後で使用するために、テストセッションで最後に使用されたパラメーターを保存します。

![](../assets/journeytest4.png)

このインターフェイスを使用すると、シンプルなイベントパラメーターを渡すことができます。 イベント内でコレクションや他の高度なオブジェクトを渡す場合は、**[!UICONTROL コードビュー]**&#x200B;をクリックして、ペイロードのコード全体を表示し、変更します。 例えば、技術ユーザーが用意したイベント情報をコピーして貼り付けることができます。

![](../assets/journeytest5.png)

技術ユーザーは、このインターフェイスを使用して、サードパーティのツールを使用せずに、イベントペイロードやトリガーイベントを作成することもできます。

「**[!UICONTROL 送信]**」ボタンをクリックすると、テストが開始されます。 ジャーニー内の個々の進行は、視覚的なフローによって表されます。 個々の人がジャーニーを移動するにつれ、パスが徐々に緑色に変わります。 エラーが発生した場合は、対応するステップに警告記号が表示されます。 カーソルをエラーに置くと、エラーに関する詳細情報が表示され、（利用可能な場合）詳細情報にアクセスできます。

![](../assets/journeytest6.png)

イベント設定画面で別のテストプロファイルを選択してテストを再実行すると、視覚的なフローが消去され、新しい個人のパスが表示されます。

テストのジャーニーを開くと、表示されるパスは最後に実行されたテストに対応します。

視覚的なフローは、インターフェイス経由でイベントがトリガーされるか、外部（例えばPostmanを使用）でイベントがトリガーされるかに関係なく機能します。

## ルールベースのジャーニーのテストモード{#test-rule-based}

テストモードは、ルールベースのイベントを使用するジャーニーでも使用できます。 ルールベースのイベントについて詳しくは、[このページ](../event/about-events.md)を参照してください。

イベントをトリガーする際に、**イベント設定**&#x200B;画面で、テストで渡すイベントパラメーターを定義できます。 右上隅のツールチップアイコンをクリックすると、イベントID条件を表示できます。 ルール評価の一部である各フィールドの横にもツールチップが表示されます。

![](../assets/alpha-event8.png)

テストモードの使用方法について詳しくは、[このページ](../building-journeys/testing-the-journey.md)を参照してください。

## ログの表示 {#viewing_logs}

「**[!UICONTROL ログを表示]**」ボタンを使用すると、テスト結果を表示できます。 このページには、ジャーニーの現在の情報がJSON形式で表示されます。 ボタンを使用すると、ノード全体をコピーできます。 ジャーニーのテスト結果を更新するには、ページを手動で更新する必要があります。

![](../assets/journeytest3.png)

>[!NOTE]
>
>テストログでは、サードパーティシステム（データソースまたはアクション）の呼び出し時にエラーが発生した場合、エラーコードとエラー応答が表示されます。

現在ジャーニー内に存在する個人（技術的にはインスタンスと呼ばれます）の数が表示されます。 次に、各個人に関する便利な情報を示します。

* _ID_:ジャーニーにおける個人の内部ID。これはデバッグ目的で使用できます。
* _currentstep_:個人が旅に出るステップ。アクティビティをより簡単に識別できるように、アクティビティにラベルを追加することをお勧めします。
* _currentstep_  > phase:ジャーニーのステータス（実行、完了、エラーまたはタイムアウト）。詳しくは、以下を参照してください。
* _currentstep_  >  _extraInfo_:エラーの説明とその他のコンテキスト情報。
* _currentstep_ / _fetchErrors_:この手順で発生したデータ取得エラーに関する情報。
* _externalKeys_:イベントで定義されたキー数式の値。
* _enrichedData_:ジャーニーがデータソースを使用する場合にジャーニーが取得したデータ。
* _transitionHistory_:個人が従った手順のリスト。イベントの場合は、ペイロードが表示されます。
* _actionExecutionErrors_ :発生したエラーに関する情報。

次に、各個人のジャーニーのステータスを示します。

* _実行中_:現在、個人がジャーニーに参加しています。
* _終了_:個人は旅の終わりだ。
* _エラー_:個人はエラーのためジャーニーで停止します。
* _タイムアウト_:時間がかかりすぎたステップのため、個人は旅の中で停止します。

テストモードを使用してイベントがトリガーされると、ソースの名前でデータセットが自動的に生成されます。

テストモードを使用してイベントがトリガーされると、ソースの名前でデータセットが自動的に生成されます。

テストモードでは、エクスペリエンスイベントが自動的に作成され、Adobe Experience Platformに送信されます。 このエクスペリエンスイベントのソースの名前は、「Journey Orchestrationテストイベント」です。

複数のジャーニーからトリガーされる複数のイベントの場合

異なるスキーマを持つ複数のジャーニーから送信される複数のイベントがある場合、シナリオがあります。 スキーマを1つのデータセットにマッピングできますか？ そうでない場合は、複数のデータセットが必要です。

宛先データセットがエクスペリエンスイベントに含まれていない場合、これらのデータセットの自動作成と名前付けが実行されます。 そのため、今日、「ボイジャー用に自動的に作成されたデータセット」が見られます。

ソースの命名により、自動作成が実行されます。 複数のイベントがある場合は、連結し、「Journey Orchestrationテストイベント — スキーマ名」にする必要があります。 これは、自動的に「Journey Orchestrationテストイベント用に自動生成されたデータセット — スキーマ名」に変わります。
